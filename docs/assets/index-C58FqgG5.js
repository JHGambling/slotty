var Xn=Object.defineProperty;var Zn=(e,t,n)=>t in e?Xn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var re=(e,t,n)=>Zn(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const Qn="5";var tn;typeof window<"u"&&((tn=window.__svelte??(window.__svelte={})).v??(tn.v=new Set)).add(Qn);let It=!1,tr=!1;function er(){It=!0}er();const nr=1,rr=2,ir=16,sr=1,or=2,F=Symbol(),qe=!1;var pe=Array.isArray,ur=Array.prototype.indexOf,_e=Array.from,en=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,lr=Object.getOwnPropertyDescriptors,ar=Object.prototype,cr=Array.prototype,nn=Object.getPrototypeOf,$e=Object.isExtensible;const ht=()=>{};function fr(e){return e()}function le(e){for(var t=0;t<e.length;t++)e[t]()}const P=2,rn=4,Kt=8,we=16,Y=32,dt=64,ge=128,$=256,Wt=512,B=1024,V=2048,st=4096,J=8192,me=16384,sn=32768,ye=65536,We=1<<17,hr=1<<18,on=1<<19,ae=1<<20,Ct=Symbol("$state"),un=new class extends Error{constructor(){super(...arguments);re(this,"name","StaleReactionError");re(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function ln(e){return e===this.v}function an(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function cn(e){return!an(e,this.v)}function dr(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function vr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function pr(e){throw new Error("https://svelte.dev/e/effect_orphan")}function _r(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function wr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function gr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function mr(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function yr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let N=null;function Me(e){N=e}function fn(e,t=!1,n){var r=N={p:N,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};It&&!t&&(N.l={s:null,u:null,r1:[],r2:Dt(!1)}),Ne(()=>{r.d=!0})}function hn(e){const t=N;if(t!==null){const u=t.e;if(u!==null){var n=y,r=g;t.e=null;try{for(var s=0;s<u.length;s++){var i=u[s];nt(i.effect),H(i.reaction),Nn(i.fn)}}finally{nt(n),H(r)}}N=t.p,t.m=!0}return{}}function Jt(){return!It||N!==null&&N.l===null}function Et(e){if(typeof e!="object"||e===null||Ct in e)return e;const t=nn(e);if(t!==ar&&t!==cr)return e;var n=new Map,r=pe(e),s=X(0),i=g,u=f=>{var c=g;H(i);var l=f();return H(c),l};return r&&n.set("length",X(e.length)),new Proxy(e,{defineProperty(f,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&wr();var o=n.get(c);return o===void 0?o=u(()=>{var a=X(l.value);return n.set(c,a),a}):w(o,l.value,!0),!0},deleteProperty(f,c){var l=n.get(c);if(l===void 0){if(c in f){const h=u(()=>X(F));n.set(c,h),ie(s)}}else{if(r&&typeof c=="string"){var o=n.get("length"),a=Number(c);Number.isInteger(a)&&a<o.v&&w(o,a)}w(l,F),ie(s)}return!0},get(f,c,l){var v;if(c===Ct)return e;var o=n.get(c),a=c in f;if(o===void 0&&(!a||(v=Tt(f,c))!=null&&v.writable)&&(o=u(()=>{var d=Et(a?f[c]:F),C=X(d);return C}),n.set(c,o)),o!==void 0){var h=p(o);return h===F?void 0:h}return Reflect.get(f,c,l)},getOwnPropertyDescriptor(f,c){var l=Reflect.getOwnPropertyDescriptor(f,c);if(l&&"value"in l){var o=n.get(c);o&&(l.value=p(o))}else if(l===void 0){var a=n.get(c),h=a==null?void 0:a.v;if(a!==void 0&&h!==F)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return l},has(f,c){var h;if(c===Ct)return!0;var l=n.get(c),o=l!==void 0&&l.v!==F||Reflect.has(f,c);if(l!==void 0||y!==null&&(!o||(h=Tt(f,c))!=null&&h.writable)){l===void 0&&(l=u(()=>{var v=o?Et(f[c]):F,d=X(v);return d}),n.set(c,l));var a=p(l);if(a===F)return!1}return o},set(f,c,l,o){var A;var a=n.get(c),h=c in f;if(r&&c==="length")for(var v=l;v<a.v;v+=1){var d=n.get(v+"");d!==void 0?w(d,F):v in f&&(d=u(()=>X(F)),n.set(v+"",d))}if(a===void 0)(!h||(A=Tt(f,c))!=null&&A.writable)&&(a=u(()=>X(void 0)),w(a,Et(l)),n.set(c,a));else{h=a.v!==F;var C=u(()=>Et(l));w(a,C)}var D=Reflect.getOwnPropertyDescriptor(f,c);if(D!=null&&D.set&&D.set.call(o,l),!h){if(r&&typeof c=="string"){var m=n.get("length"),b=Number(c);Number.isInteger(b)&&b>=m.v&&w(m,b+1)}ie(s)}return!0},ownKeys(f){p(s);var c=Reflect.ownKeys(f).filter(a=>{var h=n.get(a);return h===void 0||h.v!==F});for(var[l,o]of n)o.v!==F&&!(l in f)&&c.push(l);return c},setPrototypeOf(){gr()}})}function ie(e,t=1){w(e,e.v+t)}function be(e){var t=P|V,n=g!==null&&(g.f&P)!==0?g:null;return y===null||n!==null&&(n.f&$)!==0?t|=$:y.f|=on,{ctx:N,deps:null,effects:null,equals:ln,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??y,ac:null}}function qt(e){const t=be(e);return t.equals=cn,t}function dn(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)et(t[n])}}function br(e){for(var t=e.parent;t!==null;){if((t.f&P)===0)return t;t=t.parent}return null}function vn(e){var t,n=y;nt(br(e));try{dn(e),t=Rn(e)}finally{nt(n)}return t}function pn(e){var t=vn(e);if(e.equals(t)||(e.v=t,e.wv=kn()),!pt){var n=(tt||(e.f&$)!==0)&&e.deps!==null?st:B;K(e,n)}}const St=new Map;function Dt(e,t){var n={f:0,v:e,reactions:null,equals:ln,rv:0,wv:0};return n}function X(e,t){const n=Dt(e);return Lr(n),n}function Z(e,t=!1,n=!0){var s;const r=Dt(e);return t||(r.equals=cn),It&&n&&N!==null&&N.l!==null&&((s=N.l).s??(s.s=[])).push(r),r}function I(e,t){return w(e,Yt(()=>p(e))),t}function w(e,t,n=!1){g!==null&&(!G||(g.f&We)!==0)&&Jt()&&(g.f&(P|we|We))!==0&&!(O!=null&&O[1].includes(e)&&O[0]===g)&&mr();let r=n?Et(t):t;return _n(e,r)}function _n(e,t){if(!e.equals(t)){var n=e.v;pt?St.set(e,t):St.set(e,n),e.v=t,(e.f&P)!==0&&((e.f&V)!==0&&vn(e),K(e,(e.f&$)===0?B:st)),e.wv=kn(),wn(e,V),Jt()&&y!==null&&(y.f&B)!==0&&(y.f&(Y|dt))===0&&(M===null?Fr([e]):M.push(e))}return t}function wn(e,t){var n=e.reactions;if(n!==null)for(var r=Jt(),s=n.length,i=0;i<s;i++){var u=n[i],f=u.f;(f&V)===0&&(!r&&u===y||(K(u,t),(f&(B|$))!==0&&((f&P)!==0?wn(u,st):Se(u))))}}let Er=!1;var Pe,gn,mn,yn;function Nr(){if(Pe===void 0){Pe=window,gn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;mn=Tt(t,"firstChild").get,yn=Tt(t,"nextSibling").get,$e(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),$e(n)&&(n.__t=void 0)}}function bn(e=""){return document.createTextNode(e)}function ce(e){return mn.call(e)}function Ee(e){return yn.call(e)}function gt(e,t){return ce(e)}function mt(e,t=1,n=!1){let r=e;for(;t--;)r=Ee(r);return r}function Tr(e){e.textContent=""}function En(e){y===null&&g===null&&pr(),g!==null&&(g.f&$)!==0&&y===null&&vr(),pt&&dr()}function Cr(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function vt(e,t,n,r=!0){var s=y,i={ctx:N,deps:null,nodes_start:null,nodes_end:null,f:e|V,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Ae(i),i.f|=sn}catch(c){throw et(i),c}else t!==null&&Se(i);var u=n&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&(on|ge))===0;if(!u&&r&&(s!==null&&Cr(i,s),g!==null&&(g.f&P)!==0)){var f=g;(f.effects??(f.effects=[])).push(i)}return i}function Ne(e){const t=vt(Kt,null,!1);return K(t,B),t.teardown=e,t}function fe(e){En();var t=y!==null&&(y.f&Y)!==0&&N!==null&&!N.m;if(t){var n=N;(n.e??(n.e=[])).push({fn:e,effect:y,reaction:g})}else{var r=Nn(e);return r}}function Ar(e){return En(),Dr(e)}function Sr(e){const t=vt(dt,e,!0);return(n={})=>new Promise(r=>{n.outro?Mt(t,()=>{et(t),r(void 0)}):(et(t),r(void 0))})}function Nn(e){return vt(rn,e,!1)}function Dr(e){return vt(Kt,e,!0)}function se(e,t=[],n=be){const r=t.map(n);return Te(()=>e(...r.map(p)))}function Te(e,t=0){var n=vt(Kt|we|t,e,!0);return n}function Ot(e,t=!0){return vt(Kt|Y,e,!0,t)}function Tn(e){var t=e.teardown;if(t!==null){const n=pt,r=g;Be(!0),H(null);try{t.call(null)}finally{Be(n),H(r)}}}function Cn(e,t=!1){var s;var n=e.first;for(e.first=e.last=null;n!==null;){(s=n.ac)==null||s.abort(un);var r=n.next;(n.f&dt)!==0?n.parent=null:et(n,t),n=r}}function Or(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Y)===0&&et(t),t=n}}function et(e,t=!0){var n=!1;(t||(e.f&hr)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Ir(e.nodes_start,e.nodes_end),n=!0),Cn(e,t&&!n),Ht(e,0),K(e,me);var r=e.transitions;if(r!==null)for(const i of r)i.stop();Tn(e);var s=e.parent;s!==null&&s.first!==null&&An(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ir(e,t){for(;e!==null;){var n=e===t?null:Ee(e);e.remove(),e=n}}function An(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Mt(e,t){var n=[];Ce(e,n,!0),Sn(n,()=>{et(e),t&&t()})}function Sn(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function Ce(e,t,n){if((e.f&J)===0){if(e.f^=J,e.transitions!==null)for(const u of e.transitions)(u.is_global||n)&&t.push(u);for(var r=e.first;r!==null;){var s=r.next,i=(r.f&ye)!==0||(r.f&Y)!==0;Ce(r,t,i?n:!1),r=s}}}function Pt(e){Dn(e,!0)}function Dn(e,t){if((e.f&J)!==0){e.f^=J;for(var n=e.first;n!==null;){var r=n.next,s=(n.f&ye)!==0||(n.f&Y)!==0;Dn(n,s?t:!1),n=r}if(e.transitions!==null)for(const i of e.transitions)(i.is_global||t)&&i.in()}}let Bt=[];function kr(){var e=Bt;Bt=[],le(e)}function xr(e){Bt.length===0&&queueMicrotask(kr),Bt.push(e)}function Rr(e){var t=y;if((t.f&sn)===0){if((t.f&ge)===0)throw e;t.fn(e)}else On(e,t)}function On(e,t){for(;t!==null;){if((t.f&ge)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let he=!1,jt=null,it=!1,pt=!1;function Be(e){pt=e}let $t=[];let g=null,G=!1;function H(e){g=e}let y=null;function nt(e){y=e}let O=null;function Lr(e){g!==null&&g.f&ae&&(O===null?O=[g,[e]]:O[1].push(e))}let R=null,U=0,M=null;function Fr(e){M=e}let In=1,Gt=0,tt=!1;function kn(){return++In}function Vt(e){var a;var t=e.f;if((t&V)!==0)return!0;if((t&st)!==0){var n=e.deps,r=(t&$)!==0;if(n!==null){var s,i,u=(t&Wt)!==0,f=r&&y!==null&&!tt,c=n.length;if(u||f){var l=e,o=l.parent;for(s=0;s<c;s++)i=n[s],(u||!((a=i==null?void 0:i.reactions)!=null&&a.includes(l)))&&(i.reactions??(i.reactions=[])).push(l);u&&(l.f^=Wt),f&&o!==null&&(o.f&$)===0&&(l.f^=$)}for(s=0;s<c;s++)if(i=n[s],Vt(i)&&pn(i),i.wv>e.wv)return!0}(!r||y!==null&&!tt)&&K(e,B)}return!1}function xn(e,t,n=!0){var r=e.reactions;if(r!==null)for(var s=0;s<r.length;s++){var i=r[s];O!=null&&O[1].includes(e)&&O[0]===g||((i.f&P)!==0?xn(i,t,!1):t===i&&(n?K(i,V):(i.f&B)!==0&&K(i,st),Se(i)))}}function Rn(e){var v;var t=R,n=U,r=M,s=g,i=tt,u=O,f=N,c=G,l=e.f;R=null,U=0,M=null,tt=(l&$)!==0&&(G||!it||g===null),g=(l&(Y|dt))===0?e:null,O=null,Me(e.ctx),G=!1,Gt++,e.f|=ae,e.ac!==null&&(e.ac.abort(un),e.ac=null);try{var o=(0,e.fn)(),a=e.deps;if(R!==null){var h;if(Ht(e,U),a!==null&&U>0)for(a.length=U+R.length,h=0;h<R.length;h++)a[U+h]=R[h];else e.deps=a=R;if(!tt||(l&P)!==0&&e.reactions!==null)for(h=U;h<a.length;h++)((v=a[h]).reactions??(v.reactions=[])).push(e)}else a!==null&&U<a.length&&(Ht(e,U),a.length=U);if(Jt()&&M!==null&&!G&&a!==null&&(e.f&(P|st|V))===0)for(h=0;h<M.length;h++)xn(M[h],e);return s!==null&&s!==e&&(Gt++,M!==null&&(r===null?r=M:r.push(...M))),o}catch(d){Rr(d)}finally{R=t,U=n,M=r,g=s,tt=i,O=u,Me(f),G=c,e.f^=ae}}function Ur(e,t){let n=t.reactions;if(n!==null){var r=ur.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&P)!==0&&(R===null||!R.includes(t))&&(K(t,st),(t.f&($|Wt))===0&&(t.f^=Wt),dn(t),Ht(t,0))}function Ht(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Ur(e,n[r])}function Ae(e){var t=e.f;if((t&me)===0){K(e,B);var n=y,r=it;y=e,it=!0;try{(t&we)!==0?Or(e):Cn(e),Tn(e);var s=Rn(e);e.teardown=typeof s=="function"?s:null,e.wv=In;var i;qe&&tr&&(e.f&V)!==0&&e.deps}finally{it=r,y=n}}}function qr(){try{_r()}catch(e){if(jt!==null)On(e,jt);else throw e}}function $r(){var e=it;try{var t=0;for(it=!0;$t.length>0;){t++>1e3&&qr();var n=$t,r=n.length;$t=[];for(var s=0;s<r;s++){var i=Mr(n[s]);Wr(i)}St.clear()}}finally{he=!1,it=e,jt=null}}function Wr(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(me|J))===0&&Vt(r)&&(Ae(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?An(r):r.fn=null))}}function Se(e){he||(he=!0,queueMicrotask($r));for(var t=jt=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(dt|Y))!==0){if((n&B)===0)return;t.f^=B}}$t.push(t)}function Mr(e){for(var t=[],n=e;n!==null;){var r=n.f,s=(r&(Y|dt))!==0,i=s&&(r&B)!==0;if(!i&&(r&J)===0){(r&rn)!==0?t.push(n):s?n.f^=B:Vt(n)&&Ae(n);var u=n.first;if(u!==null){n=u;continue}}var f=n.parent;for(n=n.next;n===null&&f!==null;)n=f.next,f=f.parent}return t}function p(e){var t=e.f,n=(t&P)!==0;if(g!==null&&!G){if(!(O!=null&&O[1].includes(e))||O[0]!==g){var r=g.deps;e.rv<Gt&&(e.rv=Gt,R===null&&r!==null&&r[U]===e?U++:R===null?R=[e]:(!tt||!R.includes(e))&&R.push(e))}}else if(n&&e.deps===null&&e.effects===null){var s=e,i=s.parent;i!==null&&(i.f&$)===0&&(s.f^=$)}return n&&(s=e,Vt(s)&&pn(s)),pt&&St.has(e)?St.get(e):e.v}function Yt(e){var t=G;try{return G=!0,e()}finally{G=t}}const Pr=-7169;function K(e,t){e.f=e.f&Pr|t}function Br(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ct in e)de(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Ct in n&&de(n)}}}function de(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{de(e[r],t)}catch{}const n=nn(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=lr(n);for(let s in r){const i=r[s].get;if(i)try{i.call(e)}catch{}}}}}function jr(e){var t=g,n=y;H(null),nt(null);try{return e()}finally{H(t),nt(n)}}const Gr=new Set,je=new Set;function Hr(e,t,n,r={}){function s(i){if(r.capture||Nt.call(t,i),!i.cancelBubble)return jr(()=>n==null?void 0:n.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?xr(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function Kr(e,t,n,r,s){var i={capture:r,passive:s},u=Hr(e,t,n,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Ne(()=>{t.removeEventListener(e,u,i)})}function Nt(e){var b;var t=this,n=t.ownerDocument,r=e.type,s=((b=e.composedPath)==null?void 0:b.call(e))||[],i=s[0]||e.target,u=0,f=e.__root;if(f){var c=s.indexOf(f);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var l=s.indexOf(t);if(l===-1)return;c<=l&&(u=c)}if(i=s[u]||e.target,i!==t){en(e,"currentTarget",{configurable:!0,get(){return i||n}});var o=g,a=y;H(null),nt(null);try{for(var h,v=[];i!==null;){var d=i.assignedSlot||i.parentNode||i.host||null;try{var C=i["__"+r];if(C!=null&&(!i.disabled||e.target===i))if(pe(C)){var[D,...m]=C;D.apply(i,[e,...m])}else C.call(i,e)}catch(A){h?v.push(A):h=A}if(e.cancelBubble||d===t||d===null)break;i=d}if(h){for(let A of v)queueMicrotask(()=>{throw A});throw h}}finally{e.__root=t,delete e.currentTarget,H(o),nt(a)}}}function Jr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Ge(e,t){var n=y;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function kt(e,t){var n=(t&sr)!==0,r=(t&or)!==0,s,i=!e.startsWith("<!>");return()=>{s===void 0&&(s=Jr(i?e:"<!>"+e),n||(s=ce(s)));var u=r||gn?document.importNode(s,!0):s.cloneNode(!0);if(n){var f=ce(u),c=u.lastChild;Ge(f,c)}else Ge(u,u);return u}}function yt(e,t){e!==null&&e.before(t)}const Vr=["touchstart","touchmove"];function Yr(e){return Vr.includes(e)}function oe(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function zr(e,t){return Xr(e,t)}const lt=new Map;function Xr(e,{target:t,anchor:n,props:r={},events:s,context:i,intro:u=!0}){Nr();var f=new Set,c=a=>{for(var h=0;h<a.length;h++){var v=a[h];if(!f.has(v)){f.add(v);var d=Yr(v);t.addEventListener(v,Nt,{passive:d});var C=lt.get(v);C===void 0?(document.addEventListener(v,Nt,{passive:d}),lt.set(v,1)):lt.set(v,C+1)}}};c(_e(Gr)),je.add(c);var l=void 0,o=Sr(()=>{var a=n??t.appendChild(bn());return Ot(()=>{if(i){fn({});var h=N;h.c=i}s&&(r.$$events=s),l=e(a,r)||{},i&&hn()}),()=>{var d;for(var h of f){t.removeEventListener(h,Nt);var v=lt.get(h);--v===0?(document.removeEventListener(h,Nt),lt.delete(h)):lt.set(h,v)}je.delete(c),a!==n&&((d=a.parentNode)==null||d.removeChild(a))}});return Zr.set(l,o),l}let Zr=new WeakMap;function He(e){N===null&&yr(),It&&N.l!==null?Qr(N).m.push(e):fe(()=>{const t=Yt(e);if(typeof t=="function")return t})}function Qr(e){var t=e.l;return t.u??(t.u={a:[],b:[],m:[]})}function Ke(e,t,[n,r]=[0,0]){var s=e,i=null,u=null,f=F,c=n>0?ye:0,l=!1;const o=(h,v=!0)=>{l=!0,a(v,h)},a=(h,v)=>{f!==(f=h)&&(f?(i?Pt(i):v&&(i=Ot(()=>v(s))),u&&Mt(u,()=>{u=null})):(u?Pt(u):v&&(u=Ot(()=>v(s,[n+1,r]))),i&&Mt(i,()=>{i=null})))};Te(()=>{l=!1,t(o),l||a(null,null)},c)}function Je(e,t){return t}function ti(e,t,n,r){for(var s=[],i=t.length,u=0;u<i;u++)Ce(t[u].e,s,!0);var f=i>0&&s.length===0&&n!==null;if(f){var c=n.parentNode;Tr(c),c.append(n),r.clear(),Q(e,t[0].prev,t[i-1].next)}Sn(s,()=>{for(var l=0;l<i;l++){var o=t[l];f||(r.delete(o.k),Q(e,o.prev,o.next)),et(o.e,!f)}})}function Ve(e,t,n,r,s,i=null){var u=e,f={flags:t,items:new Map,first:null};{var c=e;u=c.appendChild(bn())}var l=null,o=!1,a=qt(()=>{var h=n();return pe(h)?h:h==null?[]:_e(h)});Te(()=>{var h=p(a),v=h.length;o&&v===0||(o=v===0,ei(h,f,u,s,t,r,n),i!==null&&(v===0?l?Pt(l):l=Ot(()=>i(u)):l!==null&&Mt(l,()=>{l=null})),p(a))})}function ei(e,t,n,r,s,i,u){var f=e.length,c=t.items,l=t.first,o=l,a,h=null,v=[],d=[],C,D,m,b;for(b=0;b<f;b+=1){if(C=e[b],D=i(C,b),m=c.get(D),m===void 0){var A=o?o.e.nodes_start:n;h=ri(A,t,h,h===null?t.first:h.next,C,D,b,r,s,u),c.set(D,h),v=[],d=[],o=h.next;continue}if(ni(m,C,b),(m.e.f&J)!==0&&Pt(m.e),m!==o){if(a!==void 0&&a.has(m)){if(v.length<d.length){var W=d[0],x;h=W.prev;var T=v[0],z=v[v.length-1];for(x=0;x<v.length;x+=1)Ye(v[x],W,n);for(x=0;x<d.length;x+=1)a.delete(d[x]);Q(t,T.prev,z.next),Q(t,h,T),Q(t,z,W),o=W,h=z,b-=1,v=[],d=[]}else a.delete(m),Ye(m,o,n),Q(t,m.prev,m.next),Q(t,m,h===null?t.first:h.next),Q(t,h,m),h=m;continue}for(v=[],d=[];o!==null&&o.k!==D;)(o.e.f&J)===0&&(a??(a=new Set)).add(o),d.push(o),o=o.next;if(o===null)continue;m=o}v.push(m),h=m,o=m.next}if(o!==null||a!==void 0){for(var ot=a===void 0?[]:_e(a);o!==null;)(o.e.f&J)===0&&ot.push(o),o=o.next;var xt=ot.length;if(xt>0){var _t=f===0?n:null;ti(t,ot,_t,c)}}y.first=t.first&&t.first.e,y.last=h&&h.e}function ni(e,t,n,r){_n(e.v,t),e.i=n}function ri(e,t,n,r,s,i,u,f,c,l){var o=(c&nr)!==0,a=(c&ir)===0,h=o?a?Z(s,!1,!1):Dt(s):s,v=(c&rr)===0?u:Dt(u),d={i:v,v:h,k:i,a:null,e:null,prev:n,next:r};try{return d.e=Ot(()=>f(e,h,v,l),Er),d.e.prev=n&&n.e,d.e.next=r&&r.e,n===null?t.first=d:(n.next=d,n.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function Ye(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,s=t?t.e.nodes_start:n,i=e.e.nodes_start;i!==r;){var u=Ee(i);s.before(i),i=u}}function Q(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}const ze=[...` 	
\r\f \v\uFEFF`];function ii(e,t,n){var r=e==null?"":""+e;if(n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,u=0;(u=r.indexOf(s,u))>=0;){var f=u+i;(u===0||ze.includes(r[u-1]))&&(f===r.length||ze.includes(r[f]))?r=(u===0?"":r.substring(0,u))+r.substring(f+1):u=f}}return r===""?null:r}function Ft(e,t,n,r,s,i){var u=e.__className;if(u!==n||u===void 0){var f=ii(n,r,i);f==null?e.removeAttribute("class"):e.className=f,e.__className=n}else if(i&&s!==i)for(var c in i){var l=!!i[c];(s==null||l!==!!s[c])&&e.classList.toggle(c,l)}return i}function si(e=!1){const t=N,n=t.l.u;if(!n)return;let r=()=>Br(t.s);if(e){let s=0,i={};const u=be(()=>{let f=!1;const c=t.s;for(const l in c)c[l]!==i[l]&&(i[l]=c[l],f=!0);return f&&s++,s});r=()=>p(u)}n.b.length&&Ar(()=>{Xe(t,r),le(n.b)}),fe(()=>{const s=Yt(()=>n.m.map(fr));return()=>{for(const i of s)typeof i=="function"&&i()}}),n.a.length&&fe(()=>{Xe(t,r),le(n.a)})}function Xe(e,t){if(e.l.s)for(const n of e.l.s)p(n);t()}function Ln(e,t,n){if(e==null)return t(void 0),ht;const r=Yt(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const at=[];function oi(e,t=ht){let n=null;const r=new Set;function s(f){if(an(e,f)&&(e=f,n)){const c=!at.length;for(const l of r)l[1](),at.push(l,e);if(c){for(let l=0;l<at.length;l+=2)at[l][0](at[l+1]);at.length=0}}}function i(f){s(f(e))}function u(f,c=ht){const l=[f,c];return r.add(l),r.size===1&&(n=t(s,i)||ht),f(e),()=>{r.delete(l),r.size===0&&n&&(n(),n=null)}}return{set:s,update:i,subscribe:u}}function ui(e){let t;return Ln(e,n=>t=n)(),t}let ve=Symbol();function li(e,t,n){const r=n[t]??(n[t]={store:null,source:Z(void 0),unsubscribe:ht});if(r.store!==e&&!(ve in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=ht;else{var s=!0;r.unsubscribe=Ln(e,i=>{s?r.source.v=i:w(r.source,i)}),s=!1}return e&&ve in n?ui(e):p(r.source)}function ai(){const e={};function t(){Ne(()=>{for(var n in e)e[n].unsubscribe();en(e,ve,{enumerable:!1,value:!0})})}return[e,t]}var L;(function(e){e.CONNECT="connect",e.DISCONNECT="disconnect",e.AUTH_SUCCESS="auth:success",e.AUTH_FAIL="auth:fail",e.AUTH_REVOKED="auth:revoked",e.ERROR="error"})(L||(L={}));var ct=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class ci{constructor(t,n={}){this.client=t,this.options=n,this.isAuthenticated=!1,this.authenticatedAs=0,this.authenticationExpiresAt=new Date(0),this.user=null,this.usedToken=null}authFromLocalStorage(){return ct(this,void 0,void 0,function*(){if(!this.options.enableAuthFromLocalStorage)return!1;let t=localStorage.getItem("casino-token");return t?this.authenticate(t):!1})}register(t,n,r){return ct(this,void 0,void 0,function*(){const s=(yield this.client.socket.request("auth/register",{username:t,password:n,displayName:r})).payload;return s.success?{success:yield this.authenticate(s.token||"",this.options.clientType||"app"),userAlreadyTaken:!1}:(this.client.emit(L.AUTH_FAIL,s.userAlreadyExists?"Username already taken":"Registration failed"),{success:!1,userAlreadyTaken:s.userAlreadyExists})})}login(t,n){return ct(this,void 0,void 0,function*(){const r=(yield this.client.socket.request("auth/login",{username:t,password:n})).payload;return r.success?{success:yield this.authenticate(r.token||""),userNotFound:!1}:(this.client.emit(L.AUTH_FAIL,r.userDoesNotExist?"User not found":"Invalid credentials"),{success:!1,userNotFound:r.userDoesNotExist})})}authenticate(t,n="app"){return ct(this,void 0,void 0,function*(){const r=(yield this.client.socket.request("auth/authenticate",{token:t,clientType:n})).payload;return r.success?(this.isAuthenticated=!0,this.authenticatedAs=r.userID,this.authenticationExpiresAt=new Date(r.expiresAt),this.options.enableAuthFromLocalStorage&&localStorage.setItem("casino-token",t),this.user=yield this.fetchUser(),this.usedToken=t,this.client.emit(L.AUTH_SUCCESS,this.authenticatedAs),!0):(this.revokeAuth(),this.usedToken=null,this.client.emit(L.AUTH_FAIL,"Authentication failed"),!1)})}fetchUser(){return ct(this,void 0,void 0,function*(){return this.isAuthenticated?yield this.client.users.getCurrentUser():null})}revokeAuth(){console.log("Revoking auth"),this.isAuthenticated&&(this.user=null,this.isAuthenticated=!1,this.authenticatedAs=-1,this.authenticationExpiresAt=new Date(0),localStorage.removeItem("casino-token"),this.client.emit(L.AUTH_REVOKED))}doesUserExist(t){return ct(this,void 0,void 0,function*(){try{const n=(yield this.client.socket.request("auth/does_user_exist",{username:t})).payload;return n.userExists&&n.success}catch(n){return this.client.emit(L.ERROR,n instanceof Error?n:new Error(String(n))),!1}})}}class De{constructor(t){this.subscribers=new Set,this.value=t,this.svelte=oi(t),this.subscribe(n=>{this.svelte.set(n)}),this.svelte.subscribe(n=>{this.value!==n&&(this.value=n,this.notifyExcept(this.svelte))})}get(){return this.value}set(t){this.value!==t&&(this.value=t,this.notify())}update(t){this.set(t(this.value)),this.svelte.update(t)}subscribe(t){return this.subscribers.add(t),t(this.value),()=>{this.subscribers.delete(t)}}notify(){for(const t of this.subscribers)t(this.value)}notifyExcept(t){for(const n of this.subscribers)n!==t&&n(this.value)}derived(t){const n=new De(t(this.value));return this.subscribe(r=>{n.set(t(r))}),n}}function At(e){return new De(e)}var Ze=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class fi{constructor(t,n){this.client=t,this.store=At(n)}reset(){this.store.set({ID:-1,Username:"",DisplayName:"",IsAdmin:!1,JoinedAt:""})}get id(){return this.store.get().ID}get username(){return this.store.get().Username}get displayName(){return this.store.get().DisplayName}get joinedAt(){return new Date(this.store.get().JoinedAt)}get isAdmin(){return this.store.get().IsAdmin}get data(){return this.store.get()}updateDisplayName(t){return Ze(this,void 0,void 0,function*(){const n=yield this.client.users.update(this.id,{DisplayName:t});if(n.err)throw new Error(`Failed to update display name: ${n.err}`);this.store.update(r=>Object.assign(Object.assign({},r),{DisplayName:t}))})}refresh(){return Ze(this,void 0,void 0,function*(){const t=yield this.client.users.findById(this.id);if(t.err)throw new Error(`Failed to refresh user data: ${t.err}`);this.store.set(t.result)})}}var bt=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class hi{constructor(t,n){this.client=t,this.store=At(n),t.db.subscribeTable("wallets",r=>{this.store.set(r.data)})}get id(){return this.store.get().ID}get userId(){return this.store.get().UserID}get hasReceivedStartingBonus(){return this.store.get().ReceivedStartingBonus}get networthCents(){return this.store.get().NetworthCents}get networth(){return this.store.get().NetworthCents/100}get data(){return this.store.get()}updateNetworth(t){return bt(this,void 0,void 0,function*(){const n=yield this.client.wallets.update(this.id,{NetworthCents:t});if(n.err)throw new Error(`Failed to update networth: ${n.err}`);this.store.update(r=>Object.assign(Object.assign({},r),{NetworthCents:t}))})}addFunds(t){return bt(this,void 0,void 0,function*(){const r=this.store.get().NetworthCents+t;yield this.updateNetworth(r)})}removeFunds(t){return bt(this,void 0,void 0,function*(){const n=this.store.get();if(n.NetworthCents<t)throw new Error("Insufficient funds");const r=n.NetworthCents-t;yield this.updateNetworth(r)})}markStartingBonusReceived(){return bt(this,void 0,void 0,function*(){if(this.store.get().ReceivedStartingBonus)return;const t=yield this.client.wallets.update(this.id,{ReceivedStartingBonus:!0});if(t.err)throw new Error(`Failed to mark starting bonus as received: ${t.err}`);this.store.update(n=>Object.assign(Object.assign({},n),{ReceivedStartingBonus:!0}))})}refresh(){return bt(this,void 0,void 0,function*(){const t=yield this.client.wallets.findById(this.id);if(t.err)throw new Error(`Failed to refresh wallet data: ${t.err}`);this.store.set(t.result)})}formatNetworth(t="$"){return`${t}${this.networth.toFixed(2)}`}updateData(t){this.store.set(t)}resetData(t){this.store.set(t)}}var k;(function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING"})(k||(k={}));var q;(function(e){e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.MESSAGE="message",e.ERROR="error",e.RECONNECTING="reconnecting",e.PING="ping"})(q||(q={}));class di extends Error{constructor(t,n){super(t),this.nonce=n,this.name="RequestTimeoutError"}}var ue=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class vi{constructor(t){this.client=t,this.isConnectedStore=At(!1),this.isAuthenticatedStore=At(!1),this.pingTimeStore=At(0);const n={ID:-1,Username:"",DisplayName:"",IsAdmin:!1,JoinedAt:""},r={ID:-1,NetworthCents:0,ReceivedStartingBonus:!0,UserID:-1};this.user=new fi(this.client,n),this.wallet=new hi(this.client,r),this.client.on(L.AUTH_SUCCESS,()=>ue(this,void 0,void 0,function*(){this.isAuthenticatedStore.set(!0),yield this.refreshCurrentUser()})),this.client.on(L.AUTH_REVOKED,()=>{this.isAuthenticatedStore.set(!1),this.user.reset(),this.wallet.resetData({ID:-1,NetworthCents:0,ReceivedStartingBonus:!0,UserID:-1})}),this.client.on(L.CONNECT,()=>{this.isConnectedStore.set(!0)}),this.client.on(L.DISCONNECT,()=>{this.isConnectedStore.set(!1)}),this.isConnectedStore.set(this.client.socket.getStatus()===k.CONNECTED),this.isAuthenticatedStore.set(this.client.auth.isAuthenticated)}refreshCurrentUser(){return ue(this,void 0,void 0,function*(){const t=yield this.client.users.getCurrentUser();return t?(this.user.store.set(t),yield this.refreshWallet(),this.user):null})}refreshWallet(){return ue(this,void 0,void 0,function*(){const t=yield this.client.wallets.getCurrentWallet();return t?(this.wallet.updateData(t),this.wallet):null})}}var pi=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class _i{constructor(t){this.client=t,this.subscriptions=[]}performOperation(t,n,r,s){return pi(this,void 0,void 0,function*(){const i=(yield this.client.socket.request("db/op",{table:t,operation:n,op_id:r,op_data:s})).payload;return{result:i.result,err:i.err,exec_time_us:i.exec_time_us}})}subscribeTable(t,n){this.subscribeRecord(t,0,n)}subscribeRecord(t,n,r){this.subscriptions.push({tableID:t,recordID:n,callback:r});try{this.client.socket.send("db/sub",{operation:"subscribe",tableID:t,resourceID:n})}catch(s){console.log(s)}}resendSubscriptions(){for(var t of this.subscriptions)this.client.socket.send("db/sub",{operation:"subscribe",tableID:t.tableID,resourceID:t.recordID})}handleSubUpdatePacket(t){for(var n of this.subscriptions)this.matchesSubscription(n,t)&&n.callback(t)}matchesSubscription(t,n){return t.tableID!=n.tableID?!1:t.recordID==0?!0:t.recordID==n.resourceID}}var ft=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class Fn{constructor(t,n){this.client=t,this.tableId=n}create(t){return ft(this,void 0,void 0,function*(){return this.client.db.performOperation(this.tableId,"create",null,t)})}findById(t){return ft(this,void 0,void 0,function*(){return this.client.db.performOperation(this.tableId,"findByID",t,null)})}findAll(t=10,n=0){return ft(this,void 0,void 0,function*(){return this.client.db.performOperation(this.tableId,"findAll",t,n)})}update(t,n){return ft(this,void 0,void 0,function*(){return this.client.db.performOperation(this.tableId,"update",t,n)})}delete(t){return ft(this,void 0,void 0,function*(){return this.client.db.performOperation(this.tableId,"delete",t,null)})}performOperation(t,n,r){return ft(this,void 0,void 0,function*(){return this.client.db.performOperation(this.tableId,t,n,r)})}}var wi=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class gi extends Fn{constructor(t){super(t,"users")}getCurrentUser(){return wi(this,void 0,void 0,function*(){if(!this.client.auth.isAuthenticated)return null;try{const t=yield this.findById(this.client.auth.authenticatedAs);return t.err?(console.error("Error fetching current user:",t.err),null):t.result}catch(t){return console.error("Exception fetching current user:",t),null}})}}var mi=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class yi extends Fn{constructor(t){super(t,"wallets")}getCurrentWallet(){return mi(this,void 0,void 0,function*(){if(!this.client.auth.isAuthenticated||!this.client.auth.user)return null;if(this.client.auth.user.Wallet)return this.client.auth.user.Wallet;try{const t=yield this.findAll(100,0);return t.err?(console.error("Error fetching current wallet:",t.err),null):Array.isArray(t.result)&&t.result.find(r=>r.UserID===this.client.auth.authenticatedAs)||null}catch(t){return console.error("Exception fetching current wallet:",t),null}})}}var Qe=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class bi{constructor(t){this.ws=null,this.status=k.DISCONNECTED,this.reconnectAttempts=0,this.eventListeners=new Map,this.nextNonce=1,this.pendingRequests=new Map,this.pingTimer=null,this.latestPingTime=0,this.url=t.url,this.autoReconnect=t.autoReconnect!==!1,this.reconnectInterval=t.reconnectInterval||1e3,this.maxReconnectAttempts=t.maxReconnectAttempts||50,this.debug=t.debug||!1,this.requestTimeout=t.requestTimeout||3e4,this.pingInterval=t.pingInterval||3e4}connect(){if(this.status===k.CONNECTED||this.status===k.CONNECTING){this.log("Already connected or connecting");return}this.status=k.CONNECTING,this.log(`Connecting to ${this.url}`);try{this.ws=new WebSocket(this.url),this.configureWebSocket()}catch(t){this.handleError(t instanceof Error?t:new Error(String(t)))}}disconnect(){this.ws&&(this.status===k.CONNECTED||this.status===k.CONNECTING)&&(this.log("Disconnecting"),this.rejectAllPendingRequests(new Error("WebSocket disconnected")),this.autoReconnect=!1,this.stopPingTimer(),this.ws.close())}send(t,n={}){if(this.status!==k.CONNECTED)throw new Error("Cannot send message: WebSocket is not connected");const r=this.getNextNonce(),s={type:t,payload:n,nonce:r};return this.ws.send(JSON.stringify(s)),r}request(t,n={},r){return Qe(this,void 0,void 0,function*(){if(this.status!==k.CONNECTED)throw new Error("Cannot send request: WebSocket is not connected");const s=this.getNextNonce(),i={type:t,payload:n,nonce:s};return new Promise((u,f)=>{const c=r||this.requestTimeout,l=setTimeout(()=>{this.pendingRequests.delete(s),f(new di(`Request timeout after ${c}ms`,s))},c);this.pendingRequests.set(s,{resolve:u,reject:f,timeout:l}),this.ws.send(JSON.stringify(i)),this.log(`Sent request with nonce ${s}`,i)})})}getStatus(){return this.status}on(t,n){this.eventListeners.has(t)||this.eventListeners.set(t,[]),this.eventListeners.get(t).push(n)}off(t,n){if(!this.eventListeners.has(t))return;const r=this.eventListeners.get(t),s=r.indexOf(n);s!==-1&&r.splice(s,1)}configureWebSocket(){this.ws&&(this.ws.onopen=()=>{this.status=k.CONNECTED,this.reconnectAttempts=0,this.log("Connection established"),this.startPingTimer(),this.emit(q.CONNECTED)},this.ws.onclose=()=>{const t=this.status===k.CONNECTED;this.status=k.DISCONNECTED,this.rejectAllPendingRequests(new Error("WebSocket connection closed")),this.stopPingTimer(),t&&(this.log("Connection closed"),this.emit(q.DISCONNECTED)),this.autoReconnect&&this.attemptReconnect()},this.ws.onerror=t=>{this.log("WebSocket error",t),this.handleError(new Error("WebSocket error"))},this.ws.onmessage=t=>{this.handleMessage(t)})}handleMessage(t){try{const n=JSON.parse(t.data);if(this.log("Received packet",n),n.nonce&&this.pendingRequests.has(n.nonce)){const r=this.pendingRequests.get(n.nonce);clearTimeout(r.timeout),this.pendingRequests.delete(n.nonce),r.resolve(n),this.log(`Resolved request with nonce ${n.nonce}`)}this.emit(q.MESSAGE,n)}catch(n){this.log("Error parsing message",n),this.handleError(new Error("Failed to parse incoming message"))}}handleError(t){this.log("Error",t),this.emit(q.ERROR,t)}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){this.log("Max reconnect attempts reached");return}this.status=k.RECONNECTING,this.reconnectAttempts++,this.log(`Reconnecting: attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts}`),this.emit(q.RECONNECTING,this.reconnectAttempts),setTimeout(()=>{this.connect()},this.reconnectInterval)}emit(t,...n){if(this.eventListeners.has(t))for(const r of this.eventListeners.get(t))try{r(...n)}catch(s){console.error("Error in event listener",s)}}getNextNonce(){return this.nextNonce++}rejectAllPendingRequests(t){for(const[n,r]of this.pendingRequests)clearTimeout(r.timeout),r.reject(t);this.pendingRequests.clear()}startPingTimer(){this.stopPingTimer(),this.pingTimer=setInterval(()=>Qe(this,void 0,void 0,function*(){if(this.status===k.CONNECTED){let t=Date.now();yield this.request("ping",{});let n=Date.now()-t;this.latestPingTime=n,this.emit(q.PING,this.latestPingTime)}}),this.pingInterval)}stopPingTimer(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null)}log(...t){this.debug&&console.log("[WebSocketClient]",...t)}}var Ut=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(u){u(i)})}return new(n||(n=Promise))(function(i,u){function f(o){try{l(r.next(o))}catch(a){u(a)}}function c(o){try{l(r.throw(o))}catch(a){u(a)}}function l(o){o.done?i(o.value):s(o.value).then(f,c)}l((r=r.apply(e,t||[])).next())})};class Ei{constructor(t,n){var r;this.url=t,this.options=n,this.wasConnected=!1,this.eventListeners=new Map,this.socket=new bi({url:this.url,autoReconnect:!0,debug:!0}),this.socket.on(q.CONNECTED,()=>{this.wasConnected&&(this.onConnect(),this.emit(L.CONNECT))}),this.socket.on(q.DISCONNECTED,()=>{this.onDisconnect(),this.emit(L.DISCONNECT)}),this.socket.on(q.MESSAGE,s=>{this.handlePacket(s)}),this.socket.on(q.PING,s=>{this.casino.pingTimeStore.set(s)}),this.auth=new ci(this,{clientType:(r=this.options)===null||r===void 0?void 0:r.clientType,enableAuthFromLocalStorage:typeof(n==null?void 0:n.authenticateFromLocalStorage)=="boolean"?n.authenticateFromLocalStorage:!0}),this.db=new _i(this),this.users=new gi(this),this.wallets=new yi(this),this.casino=new vi(this)}connect(){return Ut(this,void 0,void 0,function*(){this.socket.connect(),yield this.waitForConnect(),yield this.onConnect(),this.wasConnected=!0,this.emit(L.CONNECT)})}onConnect(){var t,n,r;return Ut(this,void 0,void 0,function*(){this.wasConnected=!0,this.auth.isAuthenticated||((typeof((t=this.options)===null||t===void 0?void 0:t.authenticateFromLocalStorage)!="boolean"||((n=this.options)===null||n===void 0?void 0:n.authenticateFromLocalStorage)==!0)&&(console.log("Trying to authenticate from localstorage..."),(yield this.auth.authFromLocalStorage())&&console.log("Authenticated from local storage!")),!this.auth.isAuthenticated&&typeof((r=this.options)===null||r===void 0?void 0:r.token)=="string"&&(console.log("Trying to authenticate with options.token..."),(yield this.auth.authenticate(this.options.token))&&console.log("Authenticated from options.token!"))),this.db.resendSubscriptions()})}onDisconnect(){return Ut(this,void 0,void 0,function*(){this.auth.isAuthenticated,this.auth.isAuthenticated=!1})}waitForConnect(){return Ut(this,void 0,void 0,function*(){yield new Promise(t=>{this.socket.getStatus()===k.CONNECTED?t():this.socket.on(q.CONNECTED,t)})})}on(t,n){this.eventListeners.has(t)||this.eventListeners.set(t,[]),this.eventListeners.get(t).push(n)}off(t,n){if(!this.eventListeners.has(t))return;const r=this.eventListeners.get(t),s=r.indexOf(n);s!==-1&&r.splice(s,1)}emit(t,...n){if(this.eventListeners.has(t))for(const r of this.eventListeners.get(t))try{r(...n)}catch(s){console.error(`Error in event listener for ${t}:`,s)}}handlePacket(t){switch(t.type){case"db/sub:update":this.db.handleSubUpdatePacket(t.payload);break}}}var Ni=kt("<td> </td>"),Ti=kt('<tr class="svelte-1geciwb"></tr>'),Ci=kt("<div> </div>"),Ai=kt('<div class="confetti svelte-1geciwb"></div> <div class="jackpot-explosion svelte-1geciwb"><span class="svelte-1geciwb">💥💰 JACKPOT!!! 💰💥</span> <span class="emoji svelte-1geciwb">🎆🎇🎉🎊🤑</span></div>',1),Si=kt('<main><h1 class="svelte-1geciwb">Welcome to SLOTTY!</h1> <div class="budget svelte-1geciwb"> </div> <table><tbody class="svelte-1geciwb"></tbody></table> <button id="spin-btn" class="svelte-1geciwb">Spin (or press Space)</button> <!> <!></main>');function Di(e,t){fn(t,!1);const[n,r]=ai(),s=()=>li(o,"$walletStore",n),i=new URLSearchParams(window.location.search),u=i.get("wsUrl")||"ws://localhost:9000/ws",f=i.get("token")||"",c=new Ei(u,{authenticateFromLocalStorage:!1,clientType:"game-sdk",token:f}),l=c.casino.wallet,o=l.store;let a=["🍒","🍋","🍊","🍉","🍇","⭐"],h=3,v=5,d=Z(Array.from({length:h},()=>Array(v).fill(""))),C=!1,D=Z(!1),m=null,b=Z(""),A="",W=Z(!1),x=Z(!1),T=Z(Array.from({length:h},()=>Array(v).fill(!1)));const z=5,ot=50,xt=10,_t=15;He(async()=>{await c.connect()});function rt(){w(T,Array.from({length:h},()=>Array(v).fill(!1)))}function zt(){w(d,Array.from({length:h},()=>Array.from({length:v},()=>a[Math.floor(Math.random()*a.length)])))}function wt(_){rt();for(let E=0;E<h;E++)if(_[E].every(S=>S===_[E][0])){for(let S=0;S<v;S++)I(T,p(T)[E][S]=!0);return{type:"JACKPOT! 5 in a row",reward:ot}}for(let E=0;E<v;E++)if(_[0][E]===_[1][E]&&_[1][E]===_[2][E]){for(let S=0;S<3;S++)I(T,p(T)[S][E]=!0);return{type:"3 in a column",reward:xt}}return _[0][0]===_[1][1]&&_[1][1]===_[2][2]?(I(T,p(T)[0][0]=I(T,p(T)[1][1]=I(T,p(T)[2][2]=!0))),{type:"3 in a diagonal",reward:_t}):_[0][4]===_[1][3]&&_[1][3]===_[2][2]?(I(T,p(T)[0][4]=I(T,p(T)[1][3]=I(T,p(T)[2][2]=!0))),{type:"3 in a diagonal",reward:_t}):null}function Rt(_){_.includes("JACKPOT")?(Xt(ke),w(W,!1),setTimeout(()=>{w(W,!0)},10),setTimeout(()=>{w(W,!1)},3500)):(Xt(Ie),w(x,!1),setTimeout(()=>{w(x,!0)},10),setTimeout(()=>{w(x,!1)},2e3))}function Oe(){if(p(D)||s().NetworthCents/100<z)return;Xt(ut),w(D,!0),w(b,""),A="",rt(),l.removeFunds(z*100);let _=0;const E=1e3,S=50;m=setInterval(()=>{if(zt(),rt(),_+=S,_>=E){clearInterval(m),m=null,w(D,!1),zt();const j=wt(p(d));j?(l.addFunds(j.reward*100),w(b,`🎉 ${j.type}! You win $${j.reward} 🎉`),A=j.type,Rt(j.type)):s().NetworthCents/100<z&&w(b,"Game over! Not enough budget to spin.")}},S)}function Un(_){_.code==="Space"&&!C&&(C=!0,Oe())}function qn(_){_.code==="Space"&&(C=!1)}function $n(){w(d,Array.from({length:h},()=>Array(v).fill(a[0]))),rt(),wt(p(d)),w(b,`🎉 JACKPOT! 5 in a row! You win $${ot} 🎉`),A="JACKPOT! 5 in a row",Rt(A)}function Wn(){w(d,Array.from({length:h},()=>Array(v).fill(a[1])));for(let _=0;_<h;_++)I(d,p(d)[_][0]=a[2]);rt();for(let _=0;_<h;_++)I(d,p(d)[_][2]=a[3]);I(d,p(d)[0][0]=I(d,p(d)[1][0]=I(d,p(d)[2][0]=a[1]))),wt(p(d)),w(b,`🎉 3 in a column! You win $${xt} 🎉`),A="3 in a column",Rt(A)}function Mn(){w(d,Array.from({length:h},()=>Array(v).fill(a[4]))),rt(),I(d,p(d)[0][0]=I(d,p(d)[1][1]=I(d,p(d)[2][2]=a[5]))),wt(p(d)),w(b,`🎉 3 in a diagonal! You win $${_t} 🎉`),A="3 in a diagonal",Rt(A)}function Pn(){w(d,Array.from({length:h},()=>Array(v).fill(a[0]))),I(d,p(d)[0][0]=a[1]),rt(),wt(p(d)),w(b,"No win!"),A="",w(W,!1),w(x,!1)}const ut=new Audio("sounds/spin.flac"),Ie=new Audio("sounds/win.mp3"),ke=new Audio("sounds/jackpot.mp3");function Xt(_){_.currentTime=0,_.play()}function Lt(){ut.volume=.01,ut.play().then(()=>{ut.pause(),ut.currentTime=0,ut.volume=1}).catch(()=>{}),Ie.load(),ke.load(),window.removeEventListener("pointerdown",Lt),window.removeEventListener("keydown",Lt)}He(()=>(window.addEventListener("pointerdown",Lt),window.addEventListener("keydown",Lt),zt(),window.forceJackpot=$n,window.forceColumnWin=Wn,window.forceDiagonalWin=Mn,window.forceNoWin=Pn,()=>{window.removeEventListener("keydown",Un),window.removeEventListener("keyup",qn),m&&clearInterval(m)})),si();var Zt=Si();let xe;var Re=mt(gt(Zt),2),Bn=gt(Re),Qt=mt(Re,2);let Le;var jn=gt(Qt);Ve(jn,5,()=>p(d),Je,(_,E,S)=>{var j=Ti();Ve(j,5,()=>p(E),Je,(ee,Jn,Vn)=>{var ne=Ni();let Ue;var Yn=gt(ne);se(zn=>{Ue=Ft(ne,1,"svelte-1geciwb",null,Ue,zn),oe(Yn,p(Jn))},[()=>({"win-cell":p(T)[S][Vn]})],qt),yt(ee,ne)}),yt(_,j)});var te=mt(Qt,2),Fe=mt(te,2);{var Gn=_=>{var E=Ci();let S;var j=gt(E);se(ee=>{S=Ft(E,1,"message svelte-1geciwb",null,S,ee),oe(j,p(b))},[()=>({"jackpot-message":p(W),"otherwin-message":p(x)})],qt),yt(_,E)};Ke(Fe,_=>{p(b)&&_(Gn)})}var Hn=mt(Fe,2);{var Kn=_=>{var E=Ai();yt(_,E)};Ke(Hn,_=>{p(W)&&_(Kn)})}se((_,E,S)=>{xe=Ft(Zt,1,"svelte-1geciwb",null,xe,_),oe(Bn,`Budget: ${E??""}$`),Le=Ft(Qt,1,"slot-table svelte-1geciwb",null,Le,S),te.disabled=p(D)||s().NetworthCents/100<z},[()=>({"crazy-jackpot":p(W)}),()=>(s().NetworthCents/100).toFixed(2),()=>({spinning:p(D),"other-win":p(x)})],qt),Kr("click",te,Oe),yt(e,Zt),hn(),r()}zr(Di,{target:document.body});
